<!DOCTYPE html>
<html>
  <head>
    <title>Game Project</title>
    <style type="text/css">
    body {
        margin:0;
        padding:0;
    }
    canvas {
      display:block;
      margin:20px auto 0;
      background: #000000;
      border:1px dashed #ccc;
      background:#000;
    }
      </style>    
  </head>
  <body>
    <canvas id="canvas" width ="600" height ="600"></canvas>
    <script type="text/javascript">
    //Declare Variables
      var canvas, width = 600, height = 600, ctx;
        
      var player, alien;//these are the variables for the sprites used in this game.
      
      scrX = 4, scrY = 4,//scrX and scrY are variables that hold the coordinates of the images in the sprite sheet. Mine starts at 4,4
      
      player_x = (width / 2) - 30, player_y = height - 95, player_w = 105, player_h = 81;//variables for initially placing the player
    
      var alienMax = 5, aliens =[], alienX=5, alienY=-45, alienW=93, alienH= 84, speed = 3;
        
      //boolean variables to track keys being pressed
      var right = false;
      var left = false;
      var up = false;
      var down = false;
      
        //Here i populate the alien array. spacing them out by 40
     for (var i = 0; i < alienMax; i++) {
      aliens.push([alienX, alienY, alienW, alienH, speed]);
      alienX += alienW + 40;
    }
    
        //This is the alien draw function. loops over the array and draws them to the screen
    function drawAliens() {
     for (var i = 0; i < aliens.length; i++) {
            ctx.drawImage(alien, aliens[i][0], aliens[i][1]);
        }
    }
    
        //the move function for the aliens. and moves them down the screen.
    function moveAliens(){
        for(var i =0; i<aliens.length; i++){
            if(aliens[i][1]<height){
                aliens[i][1] += aliens[i][4];          
            }else if(aliens[i][1] > height -1){
                aliens[i][1] = -45;
            } 
        }
            
    }
    //here are 2 functions that monitor when a key is pressed and release. They switch the values of the corresponding booleans accoringly
      function keyPress(e){
        if(e.keyCode == 39) right = true;
        else if(e.keyCode == 37) left = true;
        if(e.keyCode == 38) up = true;
        else if(e.keyCode == 40) down = true;
        if(e.keyCode == 88) beamShot = true;
      }
      function keyLift(e){
        if(e.keyCode == 39) right = false;
        else if(e.keyCode == 37) left = false;
        if(e.keyCode == 38) up = false;
        else if(e.keyCode == 40) down = false;
      }
    
        //this function is responsible for drawing the player ship and the correct state from the sprite sheet
      function drawPlayer(){
          /*this is the part that controlls player movement.Its just a series of if and else if statements
          each evaluates whether the corresponding key boolean is true. It will only be true if the key is
          pressed. Then it adds 5 in that direction and swaps the sprite for the one for that direction. 
          Making our ship animated. Our sprite sheet contains 1 row and 3 columns. The 1st sprite starts at x=4 y=4   
          and then each sprite is spaced 107 along the x axis. So when we press the right key its the 3rd sprite      
          which means its 4+107+107 = 218.
          */
          if(right){
            player_x += 5;
            scrX = 218;
          }else if(left){
            player_x -= 5;
            scrX = 111;
          }else if(up){player_y -= 5;}
          
           else if(down)player_y += 5;
          
          //if the player is left of the x axis set the players x to 0
          if(player_x <0) player_x = 0;
          //if the players x + its width(because the players x will be the top edge of the player so adding width will 
          //make the x the players right edge) is right of the x axis. Set the players x to width - player width.
          if((player_x + player_w) >= width) player_x = width - player_w;
        ``//if the players y is higher than the y axis set their y to 0.
          if(player_y <=0) player_y =0;
          //if the players y + its height(because the players y will be the top edge of the player so adding height will 
          //make the y the players bottom edge) is below of the y axis. Set the players y to height - player height.
          if((player_y + player_h) >= height) player_y = height - player_h;
          
          ctx.drawImage(player, scrX, scrY, player_w, player_h, player_x, player_y, player_w, player_h);
            if(right == false || left == false){
                scrX = 4;
            }
      }
      
    //this is the gameLoop function. This is the function we will be repeating over and over using requestAnimationFrame
      function gameLoop(){
        clearCanvas();  
        moveAliens();
        drawAliens();
        drawPlayer();
        requestAnimationFrame(gameLoop);
      }
        
    //the clear canvas method
      function clearCanvas(){
        ctx.clearRect(0,0,600,600);
      }
        
    
        
    //the initialisation function. It basically initialises all the variables and then calls itself. I could have just done it manually but I read in a few books that this is a preferred method so I stuck with it.
      (function init(){
        canvas = document.getElementById('canvas');
        ctx = canvas.getContext('2d');
        player = new Image();
        player.src = 'images/players.png';
        alien = new Image();
        alien.src = 'images/alien.png';
        document.addEventListener("keydown", keyPress, false);
        document.addEventListener("keyup", keyLift, false);
      })();
    //calling the requestAnimationFrame for an indefinite amount of time  
    requestAnimationFrame(gameLoop);
    </script>
    
  </body>
</html>